
% ln -s $POPPY/rex.sty $TEXMF_LOCAL && sudo texconfig rehash
% what about the "kpsewhich --var-value=TEXMFHOME" dir?

\usepackage{ifluatex}

% texlive packages
\ifluatex
\else
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{CJKutf8}
\usepackage{extsizes}
\fi
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{hyperref}
\usepackage{url}
\usepackage{color}
\usepackage[most]{tcolorbox}
\usepackage{array}
\usepackage[shortlabels]{enumitem}
\usepackage{centernot}
\usepackage{datetime}
\usepackage{tikz}
\usetikzlibrary{arrows,petri,topaths,shapes,fit}
\usepackage{tkz-berge}
\usepackage[linesnumbered,lined,boxed,commentsnumbered,vlined]{algorithm2e}
\usepackage{parskip}
\usepackage{minted}
\usepackage[varqu]{zi4}
\usepackage{subcaption}
\usepackage{graphicx}
\usepackage{fancyvrb}
\usepackage{mathrsfs}
\usepackage{syntonly}
\usepackage[retainorgcmds]{IEEEtrantools}
\usepackage{stmaryrd}

% external packages
\usepackage{bussproofs}

\DeclarePairedDelimiter\set\{\}
\DeclarePairedDelimiter\tuple()
\DeclarePairedDelimiter\paren()
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}

%\renewcommand{\implies}{\rightarrow}

\newcommand{\bye}[1]{}
\newcommand{\LeftToRight}{$\Longrightarrow$}
\newcommand{\RightToLeft}{$\Longleftarrow$}
\newcommand{\bicond}{\leftrightarrow}
\newcommand{\smodels}{\vdash}
\newcommand{\T}{{\textsf \textbf T}}
\newcommand{\F}{{\textsf \textbf F}}
\newcommand{\True}{{\textsf \textbf{True}}}
\newcommand{\False}{{\textsf \textbf{False}}}
\newcommand{\struct}[1]{\mathcal{#1}}
\newcommand{\arity}[1]{\mathrm{ar}(#1)}
\newcommand{\rank}[1]{\mathrm{qr}(#1)}
\newcommand{\maxx}[1]{\mathrm{max}(#1)}
\newcommand{\free}[1]{\mathrm{free}(#1)}
\newcommand{\var}[1]{\mathrm{var}(#1)}
\newcommand{\eqq}{\approx}
\newcommand{\subst}[2]{[#1/#2]}
\newcommand{\val}{\mathbf{val}}
\newcommand{\modelof}[1]{\mathrm{Md}(#1)}
\newcommand{\consequenceof}[1]{\mathrm{Cn}(#1)}
\newcommand{\theoryof}[1]{\mathrm{Th}(#1)}
\newcommand{\isomorph}{\cong}
\newcommand{\FO}{\mathrm{FO}}
\newcommand{\satof}[1]{\mathsf{SAT}(#1)}
\newcommand{\finsatof}[1]{\textsf{FIN-SAT}(#1)}
\newcommand{\validityof}[1]{\textsf{Validity}(#1)}
\newcommand{\finvalidityof}[1]{\textsf{Finite-Validity}(#1)}
\newcommand{\Robinson}{\mathsf{Q}}
\newcommand{\Successor}{\mathsf{Succ}}
\newcommand{\Proj}[1]{\Pi_{#1}}
\newcommand{\Select}[1]{\sigma_{#1}}
\newcommand{\LJoin}{\ltimes}
\newcommand{\byrule}[1]{\RightLabel{\textit{#1}}}
\newcommand{\defeq}{\coloneqq}
\newcommand{\partialto}{\rightharpoonup}
\newcommand{\totalto}{\rightarrow}
\newcommand{\powset}[1]{\mathscr{Pow}(#1)}

\newcommand{\sA}{\struct{A}}
\newcommand{\sB}{\struct{B}}
\newcommand{\cC}{\struct{C}}
\newcommand{\cD}{\struct{D}}
\newcommand{\cF}{\struct{F}}
\newcommand{\cW}{\struct{W}}
\newcommand{\cQ}{\struct{Q}}
\newcommand{\cR}{\struct{R}}
\newcommand{\sN}{\struct{N}}
\newcommand{\sM}{\struct{M}}

\newcommand{\Naturals}{\mathbb{N}}
\newcommand{\Integers}{\mathbb{Z}}
\newcommand{\Rationals}{\mathbb{Q}}
\newcommand{\Reals}{\mathbb{R}}

% lualatex stuff
\ifluatex
\usepackage{fontspec}
%https://tex.stackexchange.com/questions/234757/why-is-lualatex-so-slow-and-is-there-anything-i-can-do-about-it
\ExplSyntaxOn
\cs_set:Nn \__fontspec_load_external_fontoptions:Nn
 {}
\ExplSyntaxOff

\usepackage{unicode-math}
%https://tex.stackexchange.com/questions/438890/unicode-math-use-several-calligraphic-fonts-in-parallel
\ExplSyntaxOn
\makeatletter
\cs_new:Npn\definemathgroup#1#2#3#4{
  \fontspec_set_family:Nnn\l_my_math_font_family{SmallCapsFont={},ItalicFont={},BoldFont={},Script=Math,#3}{#4}
  \exp_args:Nc\new@mathgroup{\string#1}
  \::c\::n\::f\:::\new@symbolfont{\string#1}{TU}{\l_my_math_font_family}{\seriesdefault}{\shapedefault}
  \cs_new:Npn#1##1{#2{\fam\use:c{\string#1}##1}}
}
\makeatother
\ExplSyntaxOff

% alternative math symbols
%\definemathgroup\LatinModernmathcal\symcal{}{Latin Modern Math}
\definemathgroup\Stixmathcal\symcal{}{Stix Math}
\definemathgroup\StixTwomathcal\symcal{}{Stix Two Math}
\definemathgroup\Xitsmathcal\symcal{}{XITS Math}
\definemathgroup\Asanamathcal\symcal{}{Asana Math}
\definemathgroup\Pagellamathcal\symcal{}{TeX Gyre Pagella Math}
\definemathgroup\Termesmathcal\symcal{}{TeX Gyre Termes Math}
\definemathgroup\DejaVumathcal\symcal{}{Tex Gyre DejaVu Math}
\definemathgroup\Scholamathcal\symcal{}{TeX Gyre Schola Math}
\definemathgroup\Bonummathcal\symcal{}{Tex Gyre Bonum Math}
\definemathgroup\Libertinusmathcal\symcal{}{Libertinus Math}
\definemathgroup\NeoEulermathcal\symcal{}{Neo Euler}
\definemathgroup\Cambriamathcal\symcal{}{Cambria Math}

\definemathgroup\Stixmathbb\symbb{}{Stix Math}
\definemathgroup\StixTwomathbb\symbb{}{Stix Two Math}
\definemathgroup\Xitsmathbb\symbb{}{XITS Math}
\definemathgroup\Asanamathbb\symbb{}{Asana Math}
\definemathgroup\Pagellamathbb\symbb{}{TeX Gyre Pagella Math}
\definemathgroup\Termesmathbb\symbb{}{TeX Gyre Termes Math}
\definemathgroup\DejaVumathbb\symbb{}{Tex Gyre DejaVu Math}
\definemathgroup\Scholamathbb\symbb{}{TeX Gyre Schola Math}
\definemathgroup\Bonummathbb\symbb{}{Tex Gyre Bonum Math}
\definemathgroup\Libertinusmathbb\symbb{}{Libertinus Math}
\definemathgroup\Cambriamathbb\symbb{}{Cambria Math}

%\setmainfont{}
%\setmathfont{}
\fi

% font codes are a bitch, stashed here for use in future copying
%\DeclareRobustCommand{\NewCenturySchoolbookfamily}{%
%\fontfamily{pnc}\fontseries{m}\fontshape{n}\selectfont}
%\DeclareTextFontCommand{\textpnc}{\NewCenturySchoolbookfamily}
%
%\DeclareRobustCommand{\ZapfChanceryfamily}{%
%\fontfamily{pzc}\fontseries{m}\fontshape{n}\selectfont}
%\DeclareTextFontCommand{\textpnc}{\ZapfChanceryfamily}
%
%\DeclareRobustCommand{\Courierfamily}{%
%\fontfamily{pcr}\fontseries{m}\fontshape{n}\selectfont}
%\DeclareTextFontCommand{\textpnc}{\Courierfamily}
%
%\DeclareRobustCommand{\Helveticafamily}{%
%\fontfamily{phv}\fontseries{m}\fontshape{n}\selectfont}
%\DeclareTextFontCommand{\textpnc}{\Helveticafamily}
%
%\DeclareRobustCommand{\LatinModernDunhillfamily}{%
%\fontfamily{lmdh}\fontseries{m}\fontshape{n}\selectfont}
%\DeclareTextFontCommand{\textlmdh}{\LatinModernDunhillfamily}
